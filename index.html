<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>ç‹ä¹å¿ƒçš„åšå®¢</title>
  
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
  <meta property="og:site_name" content="ç‹ä¹å¿ƒçš„åšå®¢"/>

  
    <meta property="og:image" content="undefined"/>
  

  <link href="/favicon.png" rel="icon">
  <link rel="alternate" href="/atom.xml" title="ç‹ä¹å¿ƒçš„åšå®¢" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  

</head>


<body>
  <header id="header" class="inner"><div class="alignleft">
  <h1><a href="/">ç‹ä¹å¿ƒçš„åšå®¢</a></h1>
  <h2><a href="/"></a></h2>
</div>
<nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/">Home</a></li>
    
      <li><a href="/archives">Archives</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div>
</header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper">
  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2016-09-04T03:11:14.000Z"><a href="/2016/09/04/scala-option-and-others/">2016-09-04</a></time>
      
      
  
    <h1 class="title"><a href="/2016/09/04/scala-option-and-others/">å­¦ä¹ ç¬”è®°ï¼šScalaçš„Optionä»¥åŠå…¶ä»–å®¹å™¨</a></h1>
  

    </header>
    <div class="entry">
      
        <p><em>æœ¬æ–‡ä¸»è¦æ€»ç»“Optionã€Eitherã€Tryå®¹å™¨ã€‚æœ€åç®€å•ä»‹ç»ä¸‹Scalaç¬¬ä¸‰æ–¹åº“çš„Validationç±»ã€‚<br> æœ¬æ–‡å†…å®¹æ‘˜è‡ªã€ŠScalaç¨‹åºè®¾è®¡ã€‹[ç¾]Dean Wampler Alex Payneï¼Œç‰ˆæƒå½’åŸä½œè€…æ‰€æœ‰ã€‚</em></p>
<h3 id="1ã€Option-å®¹å™¨"><a href="#1ã€Option-å®¹å™¨" class="headerlink" title="1ã€Option å®¹å™¨"></a>1ã€Option å®¹å™¨</h3><ol>
<li>Optionå®¹å™¨æ¯”è¾ƒå¸¸è§ï¼ŒJava8å’ŒJavaç¬¬ä¸‰æ–¹åº“Guavaé‡Œéƒ½æœ‰ç±»ä¼¼çš„å®ç°ã€‚  </li>
<li>Scalaé‡Œå¸¸è§çš„å®¹å™¨åƒListã€Mapç­‰éƒ½å¯ä»¥ä½¿ç”¨foræ¨å¯¼å¼ï¼ŒScalaçš„foræ¨å¯¼å¼æ˜¯ä¸€ä¸ªè¯­æ³•ç³–ï¼Œæœ€ç»ˆéƒ½ä¼šè¢«å±•å¼€ä¸ºå¯¹foreachã€mapã€flatMapã€withFilterçš„è°ƒç”¨ï¼ŒOptionå®ç°äº†è¿™äº›æ–¹æ³•ï¼Œæ‰€ä»¥å¯ä»¥åœ¨foræ¨å¯¼å¼ä¸­ä½¿ç”¨Optionå®¹å™¨ã€‚</li>
<li>Optionçš„APIå®šä¹‰ï¼š</li>
</ol>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">sealed</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Option</span>[+<span class="type">A</span>] </span>&#123; self =&gt;</div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">isEmpty</span></span>: <span class="type">Boolean</span> <span class="comment">// å­ç±»ä¼šå®ç°è¿™ä¸ªå˜é‡</span></div><div class="line"></div><div class="line">  <span class="keyword">final</span> <span class="function"><span class="keyword">def</span> <span class="title">foreach</span></span>[<span class="type">U</span>](f:<span class="type">A</span> =&gt; <span class="type">U</span>): <span class="type">Unit</span> =</div><div class="line">    <span class="keyword">if</span> (!isEmpty) f(<span class="keyword">this</span>.get)</div><div class="line"></div><div class="line">  ...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>sealed</code>å…³é”®å­—é™å®šå­ç±»å¿…é¡»å’Œçˆ¶ç±»åœ¨åŒä¸€ä¸ªæ–‡ä»¶é‡Œï¼Œ<code>self</code>æ˜¯Optionçš„åˆ«åï¼Œ<code>final</code>é™åˆ¶å­ç±»é‡å†™ï¼Œå…¶ä½™æ–¹æ³•å®šä¹‰å’Œforeachç±»ä¼¼ã€‚</p>
<h3 id="2ã€Someå’ŒNone"><a href="#2ã€Someå’ŒNone" class="headerlink" title="2ã€Someå’ŒNone"></a>2ã€Someå’ŒNone</h3><ol>
<li>è¿™ä¸¤ä¸ªæ˜¯Optionçš„å­ç±»ï¼Œåˆ†åˆ«æ˜¯éç©ºå¯¹è±¡å’Œç©ºå¯¹è±¡ã€‚</li>
<li>ä¸Šé¢åˆ—å‡ºçš„æ–¹æ³•ï¼Œåªæœ‰å½“Optionä¸ºéç©ºæ—¶ï¼Œæ‰ä¼šä½¿ç”¨ä¼ å…¥çš„å‡½æ•°å‚æ•°ï¼Œåˆ©ç”¨è¿™ä¸ªç‰¹æ€§ï¼Œå¯ä»¥æ–¹ä¾¿çš„è¿‡æ»¤å‡ºç»“æœé‡Œçš„éç©ºç»“æœã€‚åˆ†å¸ƒå¼ä»»åŠ¡æ”¶é›†ç»“æœä¹Ÿä¼šåˆ©ç”¨äº†è¿™ä¸ªç‰¹æ€§ã€‚</li>
<li>ç¤ºä¾‹ï¼š</li>
</ol>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> results: <span class="type">Seq</span>[<span class="type">Option</span>[<span class="type">Int</span>]] = <span class="type">Vector</span>(<span class="type">Some</span>(<span class="number">10</span>), <span class="type">Some</span>(<span class="number">20</span>), <span class="type">None</span>)</div><div class="line"><span class="keyword">val</span> results2 = <span class="keyword">for</span> &#123;</div><div class="line">  <span class="type">Some</span>(i) &lt;- results</div><div class="line">&#125; <span class="keyword">yield</span> (<span class="number">2</span> * i)</div><div class="line"><span class="comment">// results2:Seq[Int] = Vector(20, 40)</span></div></pre></td></tr></table></figure>
<p><code>Some(i) &lt;- results</code>ä¼šå¯¹resultsé‡Œçš„å…ƒç´ è¿›è¡Œæ¨¡å¼åŒ¹é…ï¼Œç§»é™¤Noneå…ƒç´ ï¼Œå¹¶æŠ½å–åŒ…å«çš„æ•°å€¼ã€‚åˆ©ç”¨foræ¨å¯¼å¼çš„è½¬åŒ–è§„åˆ™ï¼Œå¯ä»¥è½¬åŒ–ä¸ºï¼š<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">val</span> result2 = <span class="keyword">for</span> &#123;</div><div class="line">  <span class="type">Some</span>(i) &lt;- results withFilter &#123;</div><div class="line">    <span class="keyword">case</span> <span class="type">Some</span>(i) =&gt; <span class="literal">true</span></div><div class="line">    <span class="keyword">case</span> <span class="type">None</span> =&gt; <span class="literal">false</span></div><div class="line">  &#125; map &#123;</div><div class="line">    <span class="keyword">case</span> <span class="type">Some</span>(i) =&gt; (<span class="number">2</span> * i)</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>mapé‡Œçš„caseä¼šäº§ç”Ÿè­¦å‘Šï¼Œä¸è¿‡æ²¡å…³ç³»ï¼Œåœ¨withFilteré‡Œå·²ç»è¿‡æ»¤äº†Noneçš„æƒ…å†µï¼Œè¿è¡Œæ—¶ä»£ç ä¸ä¼šæŠ¥MatchErrorã€‚<br>åº”ç”¨ï¼šå¯¹ä¸€ç»„å€¼åšåˆæ³•æ€§æ£€æŸ¥ï¼š</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">positive</span></span>(i: <span class="type">Int</span>) : <span class="type">Option</span>[<span class="type">Int</span>] = </div><div class="line">  <span class="keyword">if</span> (i &gt; <span class="number">0</span>) <span class="type">Some</span>(i) <span class="keyword">else</span> <span class="type">None</span></div><div class="line"></div><div class="line"><span class="keyword">for</span> &#123;</div><div class="line">  i1 &lt;- positive(<span class="number">5</span>)</div><div class="line">  i2 &lt;- positive(i1 * <span class="number">10</span>)</div><div class="line">  i3 &lt;- positive(i2 * <span class="number">25</span>)</div><div class="line">  i4 &lt;- positive(i3 * <span class="number">2</span>)</div><div class="line">&#125; <span class="keyword">yield</span>(i1 + i2 + i3 + i4)</div><div class="line"><span class="comment">// ç»“æœï¼šOption[Int] = Some(3805)</span></div><div class="line"></div><div class="line"><span class="keyword">for</span> &#123;</div><div class="line">  i1 &lt;- positive(<span class="number">5</span>)</div><div class="line">  i2 &lt;- positive(i1 * <span class="number">-1</span>) <span class="comment">// ä¸€æ—¦è¿™é‡Œè¿”å›Noneï¼Œåç»­è¡¨è¾¾å¼ä¼šåœæ­¢æ‰§è¡Œï¼Œæ‰€ä»¥ä¸‹ä¸€å¥å¯ä»¥å¼•ç”¨i2å˜é‡</span></div><div class="line">  i3 &lt;- positive(i2 * <span class="number">25</span>)</div><div class="line">  i4 &lt;- positive(i3 * <span class="number">-2</span>)</div><div class="line">&#125; <span class="keyword">yield</span>(i1 + i2 + i3 + i4)</div><div class="line"><span class="comment">// ç»“æœï¼šOption[Int] = None</span></div></pre></td></tr></table></figure>
<h3 id="3ã€Eitherå®¹å™¨"><a href="#3ã€Eitherå®¹å™¨" class="headerlink" title="3ã€Eitherå®¹å™¨"></a>3ã€Eitherå®¹å™¨</h3><ol>
<li>Optionå®¹å™¨çš„Noneæœ‰ä¸ªç¼ºé™·ï¼Œå°±æ˜¯ä¸èƒ½è¿”å›ä¸ºä»€ä¹ˆæ²¡æœ‰è¿”å›å€¼ã€‚æ­¤æ—¶Eitheræ˜¯æ›¿ä»£Optionçš„ä¸€ç§è§£å†³æ–¹æ¡ˆï¼Œä¸å…¶å­—é¢æ„æ€ä¸€è‡´ï¼ŒOptionè¡¨ç¤ºå«æœ‰0æˆ–1ä¸ªå…ƒç´ ï¼ŒEitherè¡¨ç¤ºå«æœ‰è¿™ä¸ªæˆ–é‚£ä¸ªå…ƒç´ ã€‚  </li>
<li>Eitherçš„å®šä¹‰ï¼š<code>sealed abstract class Either[+A, +B] extends AnyRef</code>ï¼ŒAã€Bè¡¨ç¤ºEitherå¯¹è±¡å¯ä»¥æŒæœ‰çš„å¯¹è±¡ç±»å‹ï¼ˆå¯ä»¥ä¸åŒï¼‰ï¼ŒåŠ å·è¡¨ç¤ºå‚æ•°æ˜¯åå˜çš„ã€‚  </li>
<li>Eitheræœ‰ä¸¤ä¸ªå­ç±»ï¼Œ<code>Left[A]</code>å’Œ<code>Right[B]</code>ï¼Œé€šè¿‡è¿™ä¸¤ä¸ªå­ç±»ä»ä¸¤ä¸ªå¯èƒ½çš„å…ƒç´ ä¸­é€‰ä¸€ä¸ªã€‚Eitherçš„å†å²æ—©äºScalaï¼Œçº¦å®šç”¨Leftæ¥è¡¨ç¤ºé”™è¯¯ï¼ŒRightè¡¨ç¤ºæ­£å¸¸è¿”å›ç»“æœã€‚  </li>
<li>ç¤ºä¾‹ï¼šç”¨Eitheré‡å†™å‰é¢çš„ğŸŒ°ï¼š</li>
</ol>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">positive</span></span>(i: <span class="type">Int</span>) : <span class="type">Either</span>[<span class="type">String</span>, <span class="type">Int</span>] =</div><div class="line">  <span class="keyword">if</span> (i &gt; <span class="number">0</span>) <span class="type">Right</span>(i) <span class="keyword">else</span> <span class="type">Left</span>(<span class="string">s"non-positive number <span class="subst">$i</span>"</span>)</div><div class="line"></div><div class="line"><span class="keyword">for</span> &#123;</div><div class="line">  i1 &lt;- positive(<span class="number">5</span>).right</div><div class="line">  i2 &lt;- positive(i1 * <span class="number">10</span>).right</div><div class="line">  i3 &lt;- positive(i2 * <span class="number">25</span>).right</div><div class="line">  i4 &lt;- positive(i3 * <span class="number">2</span>).right</div><div class="line">&#125; <span class="keyword">yield</span>(i1 + i2 + i3 + i4)</div><div class="line"><span class="comment">// ç»“æœï¼šscala.util.Either[String,Int] = Right(3805)</span></div><div class="line"></div><div class="line"><span class="keyword">for</span> &#123;</div><div class="line">  i1 &lt;- positive(<span class="number">5</span>).right</div><div class="line">  i2 &lt;- positive(i1 * <span class="number">-1</span>).right <span class="comment">// å¤±è´¥</span></div><div class="line">  i3 &lt;- positive(i2 * <span class="number">25</span>).right</div><div class="line">  i4 &lt;- positive(i3 * <span class="number">-2</span>).right <span class="comment">// å¤±è´¥</span></div><div class="line">&#125; <span class="keyword">yield</span>(i1 + i2 + i3 + i4)</div><div class="line"><span class="comment">// ç»“æœï¼šscala.util.Either[String,Int] = Left(non-positive number -5)</span></div></pre></td></tr></table></figure>
<p>å’Œå‰é¢ä¸€æ ·ï¼Œä¸€æ—¦è°ƒç”¨<code>.right</code>è¿”å›çš„æ˜¯Leftç±»å‹æ—¶ï¼Œè°ƒç”¨ç»“æŸï¼Œåé¢çš„ä¸å†æ‰§è¡Œã€‚è‡³äºä¸ºä»€ä¹ˆï¼Œç›®å‰æ¥çœ‹ï¼ŒLeftå’ŒRightéƒ½å¯ä»¥è°ƒç”¨<code>left</code>å’Œ<code>right</code>æ–¹æ³•ï¼Œåˆ†åˆ«è¿”å›LeftProjectionå’ŒRightProjectionå®ä¾‹ï¼Œä½†å†å¯¹LeftProjectionå’ŒRightProjectionå–å€¼æ—¶ï¼Œforæ¨å¯¼å¼å¯ä»¥è‡ªå·±æ¨å¯¼å‡ºæ¥ã€‚æ¯”å¦‚ï¼š<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> <span class="type">L</span> = <span class="type">Left</span>(<span class="number">33</span>)</div><div class="line"><span class="keyword">val</span> left = <span class="type">L</span>.left      <span class="comment">// left = LeftProjection(Left(33))</span></div><div class="line"><span class="keyword">val</span> lvalue = left.get  <span class="comment">// lvalue = 33</span></div><div class="line"><span class="keyword">val</span> right = <span class="type">L</span>.right    <span class="comment">// right = RightProjection(Left(33))</span></div><div class="line"><span class="keyword">val</span> rvalue = right.get <span class="comment">// NoSuchElementException</span></div></pre></td></tr></table></figure></p>
<p>ç¤ºä¾‹2ï¼Œå¯¹äºå‡ºç°å¼‚å¸¸çš„æƒ…å†µï¼Œå¯ä»¥å°†å¼‚å¸¸åˆ—åœ¨è¿”å›å€¼çš„Eitherå·¦å€¼é‡Œï¼Œä¸å†é€šè¿‡æŠ›å‡ºå¼‚å¸¸æ¥æ•è·è°ƒç”¨å †æ ˆä¸­æŸäº›åº”ç”¨çš„æ§åˆ¶æƒï¼ŒåŒæ—¶è°ƒç”¨è€…æ›´èƒ½æ˜ç™½APIçš„å«ä¹‰ã€‚<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">addInts</span></span>(s1: <span class="type">String</span>, s2: <span class="type">String</span>): <span class="type">Either</span>[<span class="type">NumberFormatException</span>,<span class="type">Int</span>] = &#123;</div><div class="line">  <span class="keyword">try</span> &#123;</div><div class="line">    <span class="type">Right</span>(s1.toInt + s2.toInt)</div><div class="line">  &#125; <span class="keyword">catch</span> &#123;</div><div class="line">    <span class="keyword">case</span> nfe: <span class="type">NumberFormatException</span> =&gt; <span class="type">Left</span>(nfe)</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">println(addInts(<span class="string">"11"</span>, <span class="string">"22"</span>)) <span class="comment">// Right(33)</span></div><div class="line">println(addInts(<span class="string">"f"</span>, <span class="string">"33"</span>))  <span class="comment">// Left(java.lang.NumberFormatException: For input string: "f")</span></div></pre></td></tr></table></figure></p>
<h3 id="4ã€Tryå®¹å™¨"><a href="#4ã€Tryå®¹å™¨" class="headerlink" title="4ã€Tryå®¹å™¨"></a>4ã€Tryå®¹å™¨</h3><ol>
<li>scala.util.Tryçš„ç»“æ„å’ŒEitherç±»ä¼¼ï¼Œæœ‰ä¸¤ä¸ªå­ç±»Successå’ŒFailureï¼ŒSuccessä¸Rightç›¸ä¼¼ï¼Œä¿å­˜æ­£å¸¸çš„è¿”å›å€¼ï¼ŒFailureä¸Leftç›¸ä¼¼ï¼Œä½†æ€»æ˜¯åŒ…å«Throwableå¯¹è±¡ï¼Œæ‰€ä»¥Tryçš„å®šä¹‰åªæœ‰ä¸€ä¸ªæ³›å‹å‚æ•°ï¼š<code>sealed abstract class Try[+T] extends AnyRef</code>ã€‚</li>
<li>ç¤ºä¾‹ï¼šä»ä¸€ç»„Tryå€¼ä¸­ï¼Œè¿‡æ»¤æ‰Failureå¯¹è±¡ã€‚</li>
</ol>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> scala.util.&#123;<span class="type">Try</span>, <span class="type">Success</span>, <span class="type">Failure</span>&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">positive</span></span>(i: <span class="type">Int</span>): <span class="type">Try</span>[<span class="type">Int</span>] = <span class="type">Try</span> &#123;</div><div class="line">  assert(i &gt; <span class="number">0</span>, <span class="string">s"non-positive number <span class="subst">$i</span>"</span>)</div><div class="line">  i</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">for</span> &#123;</div><div class="line">  i1 &lt;- positive(<span class="number">5</span>)</div><div class="line">  i2 &lt;- positive(i1 * <span class="number">10</span>)</div><div class="line">  i3 &lt;- positive(i2 * <span class="number">25</span>)</div><div class="line">  i3 &lt;- positive(i3 * <span class="number">2</span>)</div><div class="line">&#125; <span class="keyword">yield</span>(i1 + i2 + i3 + i4)</div><div class="line"><span class="comment">// ç»“æœï¼šscala.util.Try[Int] = Success(3805)</span></div><div class="line"></div><div class="line"><span class="keyword">for</span> &#123;</div><div class="line">  i1 &lt;- positive(<span class="number">5</span>)</div><div class="line">  i2 &lt;- positive(i1 * <span class="number">-1</span>)</div><div class="line">  i3 &lt;- positive(i2 * <span class="number">25</span>)</div><div class="line">  i3 &lt;- positive(i3 * <span class="number">-2</span>)</div><div class="line">&#125; <span class="keyword">yield</span>(i1 + i2 + i3 + i4)</div><div class="line"><span class="comment">// ç»“æœï¼šscala.util.Try[Int] = Failure(java.lang.AssertionError: assert failed: non-positive number -5)</span></div></pre></td></tr></table></figure>
<h3 id="5ã€Scalazæä¾›çš„Validationç±»"><a href="#5ã€Scalazæä¾›çš„Validationç±»" class="headerlink" title="5ã€Scalazæä¾›çš„Validationç±»"></a>5ã€Scalazæä¾›çš„Validationç±»</h3><ol>
<li>ä»¥ä¸Šä»‹ç»çš„å®¹å™¨ï¼Œåœ¨foræ¨åˆ°ä¸­é‡åˆ°ä¸æ»¡è¶³æƒ…å†µä¼šç«‹å³åœæ­¢ï¼Œå¦‚æœæƒ³æ”¶é›†æ‰€æœ‰æ‰€æœ‰æ‰§è¡Œè¿‡ç¨‹ä¸­çš„é”™è¯¯ï¼Œå¹¶åˆ¤æ–­åé¢æ‰§è¡Œä»€ä¹ˆæ“ä½œï¼Œå…¸å‹çš„åœºæ™¯å°±æ˜¯éªŒè¯ç½‘é¡µè¡¨å•ï¼Œè¿™æ ·å¯ä»¥ä¸€æ¬¡å°†æ‰€æœ‰é”™è¯¯ä¿¡æ¯è¿”å›ã€‚Scalaæ ‡å‡†åº“æ— æ³•æä¾›è¿™æ ·çš„åŠŸèƒ½ï¼Œç¬¬ä¸‰æ–¹åº“Scalazæä¾›äº†Validationæ»¡è¶³è¿™ç§éœ€æ±‚ã€‚</li>
</ol>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> scalaz._, std.<span class="type">AllInstance</span>._</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">validName</span></span>(key: <span class="type">String</span>, name: <span class="type">String</span>): </div><div class="line">        <span class="type">Validation</span>[<span class="type">List</span>[<span class="type">String</span>], <span class="type">List</span>[(<span class="type">String</span>, <span class="type">Any</span>)]] = &#123;</div><div class="line">  <span class="keyword">val</span> n = name.trim</div><div class="line">  <span class="keyword">if</span> (n.length &gt; <span class="number">0</span> &amp;&amp; n.matches(<span class="string">""</span><span class="string">"^\p&#123;Alpha&#125;$"</span><span class="string">""</span>)) <span class="type">Success</span>(<span class="type">List</span>(key -&gt; n))</div><div class="line">  <span class="keyword">else</span> <span class="type">Failure</span>(<span class="type">List</span>(<span class="string">s"Invalid <span class="subst">$key</span> &lt;<span class="subst">$n</span>&gt;"</span>))</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">positive</span></span>(key: <span class="type">String</span>, n: <span class="type">String</span>): </div><div class="line">      <span class="type">Validation</span>[<span class="type">List</span>[<span class="type">String</span>], <span class="type">List</span>[(<span class="type">String</span>, <span class="type">Any</span>)]] = &#123;</div><div class="line">  <span class="keyword">try</span> &#123;</div><div class="line">    <span class="keyword">val</span> i = n.toInt</div><div class="line">    <span class="keyword">if</span> (i &gt; <span class="number">0</span>) <span class="type">Success</span>(<span class="type">List</span>(key -&gt; i))</div><div class="line">    <span class="keyword">else</span> <span class="type">Failure</span>(<span class="type">List</span>(<span class="string">s"Invalid <span class="subst">$key</span> <span class="subst">$i</span>"</span>))</div><div class="line">  &#125; <span class="keyword">catch</span> &#123;</div><div class="line">    <span class="keyword">case</span> _: java.lang.<span class="type">NumberFormatException</span> =&gt; <span class="type">Failure</span>(<span class="type">List</span>(<span class="string">s"<span class="subst">$n</span> is not a Integer"</span>))</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">validForm</span></span>(firstName: <span class="type">String</span>, lastName: <span class="type">String</span>, age: <span class="type">String</span>): </div><div class="line">      <span class="type">Validation</span>[<span class="type">List</span>[<span class="type">String</span>], <span class="type">List</span>[(<span class="type">String</span>, <span class="type">Any</span>)]] = &#123;</div><div class="line">  validName(<span class="string">"first-name"</span>, firstName) </div><div class="line">  +++ validName(<span class="string">"last-name"</span>, lastName) </div><div class="line">  +++ positive(<span class="string">"age"</span>, age)</div><div class="line">&#125;</div><div class="line"></div><div class="line">validForm(<span class="string">"Dean"</span>, <span class="string">"Wampler"</span>, <span class="string">"29"</span>)</div><div class="line"><span class="comment">// Success(List((first-name,Dean),(last-name,Wampler),(age,29)))</span></div><div class="line"></div><div class="line">validForm(<span class="string">""</span>, <span class="string">"Wampler"</span>, <span class="string">"0"</span>)</div><div class="line"><span class="comment">// Failure(List(Invalid first-name &lt;&gt;, Invalid age 0))</span></div></pre></td></tr></table></figure>
<p>è¿™é‡Œçš„Successå’ŒFailureå’ŒTryçš„ä¸¤ä¸ªå­ç±»ä¸æ˜¯åŒä¸€ä¸ªç±»ã€‚</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2016-07-30T13:53:26.000Z"><a href="/2016/07/30/Hello-Hexo/">2016-07-30</a></time>
      
      
  
    <h1 class="title"><a href="/2016/07/30/Hello-Hexo/">Hello Hexo</a></h1>
  

    </header>
    <div class="entry">
      
        <p>é—²çš„è›‹ç–¼çš„æˆ‘åˆå¼€å§‹æŠ˜è…¾äº†ï¼Œè¿™æ¬¡æ˜¯é€šè¿‡Hexoæ¥æ­å»ºä¸ªäººåšå®¢ï¼Œéœ€è¦æå‰äº†è§£ä¸€äº›åŒ…æ‹¬githubã€nodejsçš„åŸºæœ¬ä½¿ç”¨ï¼Œæ€ä¹ˆæ­å»ºçš„è¿‡ç¨‹å°±ä¸å¤šè¯´äº†ï¼Œç½‘ä¸Šæœ‰å¾ˆå¤šæ•™ç¨‹ï¼Œè¿™é‡Œæ¨èä¸¤ä¸ª<a href="http://beiyuu.com/github-pages" target="_blank" rel="external">æ•™ç¨‹1</a>ã€<a href="http://www.jianshu.com/p/05289a4bc8b2" target="_blank" rel="external">æ•™ç¨‹2</a>ï¼Œé‡Œé¢å¾ˆè¯¦ç»†çš„ä»‹ç»äº†æ•´ä¸ªè¿‡ç¨‹ã€‚   </p>
<p>è¿™é‡Œä¸»è¦è®°å½•ä¸‹æˆ‘åœ¨æ­å»ºè¿‡ç¨‹ä¸­é‡åˆ°çš„é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆã€‚   </p>
<h3 id="1ã€-SSH-keyå’Œä½¿ç”¨å¤šä¸ªgithubè´¦å·"><a href="#1ã€-SSH-keyå’Œä½¿ç”¨å¤šä¸ªgithubè´¦å·" class="headerlink" title="1ã€ SSH keyå’Œä½¿ç”¨å¤šä¸ªgithubè´¦å·"></a>1ã€ SSH keyå’Œä½¿ç”¨å¤šä¸ªgithubè´¦å·</h3><p>ä¸Šé¢çš„ä¸¤ä¸ªæ•™ç¨‹é‡Œæœ‰è¯´æ€ä¹ˆåœ¨æœ¬åœ°æ–°å»ºä¸€ä¸ªssh keyï¼Œå¹¶æ·»åŠ åˆ°githubçš„è¿‡ç¨‹ï¼Œå¦‚æœè¦ä½¿ç”¨ç¬¬äºŒä¸ªè´¦å·æ—¶ï¼Œæœ‰äº›ä¸åŒçš„åœ°æ–¹ã€‚é¦–å…ˆè¿›å…¥ä¿å­˜ssh keyçš„ç›®å½•</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ <span class="built_in">cd</span> ~/.ssh</div></pre></td></tr></table></figure>
<p>è¿™ä¸ªç›®å½•æ˜¯éšè—çš„ï¼Œç”¨lså‘½ä»¤ä¸ä¼šå›æ˜¾ã€‚è¿›å…¥ä¹‹åï¼Œå¦‚æœä¹‹å‰å·²ç»åˆ›å»ºäº†keyï¼Œä¼šæœ‰å¦‚ä¸‹ä¸¤ä¸ªæ–‡ä»¶</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">id_rsa  id_rsa.pub</div></pre></td></tr></table></figure>
<p>æœ‰å°è±¡å§ï¼Œç„¶åå†èµ°ä¸Šä¸€æ¬¡çš„æµç¨‹ï¼Œåœ¨.sshç›®å½•è¾“å…¥</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$ ssh-keygen -t rsa -C <span class="string">"your-email@xxx.com"</span></div><div class="line">Generating public/private rsa key pair.</div><div class="line">Enter file <span class="keyword">in</span> <span class="built_in">which</span> to save the key(~/.ssh): second_key</div><div class="line">...</div></pre></td></tr></table></figure>
<p>æ³¨æ„è¦åœ¨ä¸Šé¢çš„<strong>second_key</strong>é‚£é‡Œè¾“å…¥æ–°çš„keyåè¯ï¼Œç„¶ååé¢ä¸€è·¯å›è½¦ã€‚å®Œäº†ç›®å½•ä¸‹ä¼šæ–°å¢ä¸‹é¢ä¸¤ä¸ªæ–‡ä»¶</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">second  second.pub</div></pre></td></tr></table></figure>
<p>å¦‚æœæ˜¯åœ¨å…¶ä»–ç›®å½•ç”Ÿæˆçš„è¿™ä¸¤ä¸ªæ–‡ä»¶ï¼Œå¯ä»¥æ‹·è´åˆ°.sshç›®å½•ã€‚æŠŠsecond.pubé‡Œçš„å†…å®¹æ·»åŠ åˆ°githubè´¦å·ï¼Œå…·ä½“å¯ä»¥å‚è€ƒä¸Šé¢çš„ä¸¤ä¸ªæ•™ç¨‹ã€‚<br>å†åœ¨.sshç›®å½•æ–°å»ºä¸€ä¸ªconfigæ–‡ä»¶ï¼Œæ·»åŠ ä»¥ä¸‹å†…å®¹</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">Host defaultgit</div><div class="line">    HostName github.com</div><div class="line">    PreferredAuthentications publickey</div><div class="line">    IdentityFile ~/.ssh/id_rsa</div><div class="line"></div><div class="line">Host secondgit</div><div class="line">    HostName github.com</div><div class="line">    PreferredAuthentications publickey</div><div class="line">    IdentityFile ~/.ssh/second</div></pre></td></tr></table></figure>
<p>Host åç§°å¯ä»¥éšæ„èµ·ï¼Œè¡¨ç¤ºSSHè¿æ¥çš„å•ç‹¬ä»£å·ï¼ŒIdentityFileå‘Šè¯‰SSHå»å“ªé‡Œè¯»ç§é’¥ã€‚æ‰§è¡Œssh-addæ·»åŠ æ–°ç”Ÿæˆçš„ç§é’¥</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ ssh-add ~/.ssh/second</div></pre></td></tr></table></figure>
<p>ç„¶åæµ‹è¯•æ˜¯å¦é…ç½®æˆåŠŸ</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$ ssh -T git@defaultgit</div><div class="line">Hi yourname1! You have successfully ...</div><div class="line"></div><div class="line">$ ssh -T git@secondgit</div><div class="line">Hi yourname2! You have successfully ...</div></pre></td></tr></table></figure>
<p>å¦‚æœå‡ºç°ä¸Šé¢çš„æç¤ºï¼Œè¯´æ˜é…ç½®æˆåŠŸã€‚ä»¥åç”¨åˆ°é‚£ä¸ªè´¦å·ï¼Œå°±ä½¿ç”¨å“ªä¸ªè´¦å·Hostå¯¹åº”çš„åç§°ï¼Œä¾‹å¦‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">git <span class="built_in">clone</span> git@defaultgit:xxx/yyy.git</div><div class="line">git <span class="built_in">clone</span> git@secondgit:xxx/yyy.git</div></pre></td></tr></table></figure>
<p>ä¸Šé¢å…‹éš†äº†åŒä¸€ä¸ªä»“åº“ï¼Œä½†ä½¿ç”¨çš„æ˜¯ä¸åŒçš„SSHè¿æ¥ã€‚ä¹Ÿå¯ä»¥åªåœ¨é¡¹ç›®ä¸‹é…ç½®åŒºåˆ«äºå…¨å±€çš„è®¾ç½®</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">git config --global --unset user.name</div><div class="line">git config --global --unset user.email</div><div class="line"></div><div class="line">git config user.name <span class="string">"new name"</span></div><div class="line">git config user.email <span class="string">"new email"</span></div></pre></td></tr></table></figure>
<p>ç”¨æˆ·åçš„é‚®ç®±å°±æ˜¯æ³¨å†Œgithubè´¦å·ä½¿ç”¨çš„ç”¨æˆ·åå’Œé‚®ç®±ï¼Œè¿™æ ·åœ¨æ¯ä¸ªç›®å½•ä¸‹æäº¤å°±å¯ä»¥è‡ªåŠ¨è¯†åˆ«githubè´¦å·äº†ã€‚</p>
<h3 id="2ã€éƒ¨ç½²Hexo"><a href="#2ã€éƒ¨ç½²Hexo" class="headerlink" title="2ã€éƒ¨ç½²Hexo"></a>2ã€éƒ¨ç½²Hexo</h3><p>é…ç½®Hexoçš„éƒ¨ç½²éƒ¨åˆ†ï¼Œrepoçš„é…ç½®ç‰¹åˆ«æ³¨æ„ï¼Œéœ€è¦githubç½‘å€URL+ç”¨æˆ·å+repoåï¼Œå¦‚ä¸‹åœ¨deployèŠ‚ç‚¹</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="attr">deploy:</span></div><div class="line"><span class="attr">    type:</span> git</div><div class="line"><span class="attr">    repo:</span> https://github.com/user-name/repo-name</div><div class="line"><span class="attr">    branch:</span> master</div></pre></td></tr></table></figure>
<p>è¿™é‡Œçš„user-nameå’Œrepo-nameæ˜¯githubè´¦æˆ·çš„ç”¨æˆ·åå’Œä»“åº“åï¼Œä¸€èˆ¬æ ¼å¼ä¸º</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">https://github.com/ngbyte/ngbyte.github.com</div></pre></td></tr></table></figure>
<p>è¿˜æœ‰å°±æ˜¯éƒ¨ç½²æ—¶å€™å¦‚æœæç¤ºæ‰¾ä¸åˆ°ä»“åº“ï¼Œå¤šåŠå°±æ˜¯deployèŠ‚ç‚¹çš„repoæ²¡æœ‰é…ç½®å¥½ï¼ŒæŒ‰ç…§ä¸Šé¢æ ¼å¼æ¥å¡«å†™å°±å¯ä»¥äº†ã€‚</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2016-07-02T06:15:20.000Z"><a href="/2016/07/02/program-with-OOP-md/">2016-07-02</a></time>
      
      
  
    <h1 class="title"><a href="/2016/07/02/program-with-OOP-md/">é¢å‘å¯¹è±¡ç¼–ç¨‹çš„ä¸€äº›ä½“ä¼š</a></h1>
  

    </header>
    <div class="entry">
      
        <h3 id="1-åˆè¯†"><a href="#1-åˆè¯†" class="headerlink" title="1 åˆè¯†"></a>1 åˆè¯†</h3><p>å¤§å­¦é‡Œå­¦äº†C++ï¼Œæ²¡æ€ä¹ˆå­¦ä¼šï¼Œè€ƒè¯•ä¹Ÿè€ƒçš„ä¸€èˆ¬ï¼Œç›´åˆ°å¤§å››æ‰¾å·¥ä½œäº†ï¼Œåˆæ‹¿å‡ºæ¥å¤ä¹ äº†ä¸€æŠŠã€‚å½“æ—¶å­¦é•¿é€äº†æˆ‘ä¸€æœ¬ã€Šç¨‹åºå‘˜é¢è¯•æŒ‡å—ã€‹å¼€å§‹ä¸´æ—¶æŠ±ä½›è„šï¼ŒåŸºæœ¬ä¸ŠæŠŠè¿™æœ¬ä¹¦è¿‡äº†ä¸€éï¼Œæ”¶è·è¿˜æ˜¯æŒºå¤§çš„ï¼Œä¸€æ¬¡äº¬ä¸œçš„ç¬”è¯•æœ‰ä¸ªé¢˜é—®æ€ä¹ˆç†è§£é¢å‘å¯¹è±¡çš„å¤šæ€ï¼Œæˆ‘åªå†™äº†ä¸€å¥è¯è®°å¾—æ˜¯ï¼šè¿è¡Œæ—¶çˆ¶ç±»å¯ä»¥æŒ‡å‘å­ç±»çš„ç‰¹æ€§ã€‚ç°åœ¨çœ‹å¥½åƒä¹Ÿæ²¡ä»€ä¹ˆä¸å¯¹ã€‚</p>
<h3 id="2-é¡¹ç›®é‡Œå®è·µ"><a href="#2-é¡¹ç›®é‡Œå®è·µ" class="headerlink" title="2 é¡¹ç›®é‡Œå®è·µ"></a>2 é¡¹ç›®é‡Œå®è·µ</h3><p>æ¯•ä¸šå»äº†ç¬¬ä¸€å®¶å…¬å¸ï¼ŒåšJava Webçš„é¡¹ç›®ï¼Œå¸¦æˆ‘çš„è€å‘˜å·¥ç»™äº†æˆ‘ä¸€æœ¬ã€ŠJava ç¼–ç¨‹æ€æƒ³ã€‹ä¹Ÿæ²¡çœ‹æ‡‚å¤šå°‘å°±å¼€å§‹å†™ä»£ç ã€‚åˆšå¼€å§‹é‚£æ®µæ—¶é—´ï¼Œå½“æ—¶å†™è¿‡çš„ä¸€ä¸ªå‡½æ•°ï¼Œè®°å¾—å¤§æ¦‚æ˜¯è¿™æ ·çš„ï¼š </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> &lt;T&gt; <span class="function">List&lt;T&gt; <span class="title">doSomeThing</span><span class="params">(List&lt;T extends BaseModel&gt; list)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="comment">// ... ...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>é¡¹ç›®é‡Œï¼ŒBaseModelæ˜¯çˆ¶ç±»ï¼Œå®ƒæœ‰ä¸‰ä¸ªå­ç±»ï¼Œæˆ‘è¿™é‡Œå†™äº†ä¸€ä¸ªå…¬å…±çš„æ–¹æ³•ï¼Œå¯ä»¥æ¥æ”¶å¯¹åº”ä¸‰ä¸ªå­ç±»çš„åˆ—è¡¨å‚æ•°ï¼Œåšä¸€äº›å…¬å…±çš„å¤„ç†åè¿”å›ã€‚è¿™ä¸ªå†™æ³•ä¹Ÿæ˜¯ä»ç½‘ä¸Šæœæ¥çš„ï¼Œç”¨èµ·æ¥ä¹Ÿæ²¡ä»€ä¹ˆé—®é¢˜ï¼Œä½†å…¶å®å¹¶æ²¡æœ‰å®Œå…¨ç†è§£ã€‚è¿™é‡Œå¯ä»¥çœ‹å‡ºæ¥ç”¨åˆ°äº†ç»§æ‰¿å’Œå¤šæ€çš„çŸ¥è¯†ï¼Œä»»ä½•ç»§æ‰¿äº†BaseModelçš„ç±»çš„åˆ—è¡¨éƒ½å¯ä»¥ä½œä¸ºæ–¹æ³•çš„åˆæ³•å‚æ•°ã€‚</p>
<h3 id="3-æœ€è¿‘ä¸€æ¬¡ä½¿ç”¨"><a href="#3-æœ€è¿‘ä¸€æ¬¡ä½¿ç”¨" class="headerlink" title="3 æœ€è¿‘ä¸€æ¬¡ä½¿ç”¨"></a>3 æœ€è¿‘ä¸€æ¬¡ä½¿ç”¨</h3><p>æœ€è¿‘åšä¸€ä¸ªé¡¹ç›®ï¼Œç”¨JQueryçš„Datatableæ¥å±•ç¤ºè¡¨æ ¼ï¼Œç”±äºè¦æŠŠListç»“æœè½¬æ¢æˆç”¨å­—ç¬¦ä¸²è¡¨ç¤ºçš„äºŒç»´æ•°ç»„å½¢å¼ï¼Œå†è¿”å›ç»™Ajaxè¯·æ±‚ï¼Œè¿™æ ·jsä»£ç é‡Œåšå°‘é‡å¤„ç†å°±å¯ä»¥å±•ç¤ºå‡ºè¡¨æ ¼ã€‚ç”±äºæˆ‘ä¸­é€”æ¥æ‰‹è¿™ä¸ªé¡¹ç›®ï¼ŒæŠŠç›´æ¥ç”¨+æ‹¼æ¥åæ¥ä¸ªå±æ€§çš„ä»£ç æå–å‡ºæ¥ï¼ŒæŠŠModelç±»éƒ½æ·»åŠ ä¸€ä¸ªform()æ–¹æ³•ï¼ŒæŠŠæ‹¼æ¥å±æ€§çš„æ–¹æ³•æ”¾åœ¨é‡Œé¢ï¼ˆæ”¹ç”¨StringBuilderï¼‰ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ExampleModel</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> String name;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</div><div class="line">    <span class="keyword">private</span> String birth;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> String <span class="title">wrap</span><span class="params">(Object obj)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (obj == <span class="keyword">null</span>) &#123;</div><div class="line">            <span class="keyword">return</span> <span class="string">""</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="string">"\""</span> + obj.toString() + <span class="string">"\""</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> String <span class="title">wrapComma</span><span class="params">(Object obj)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (obj == <span class="keyword">null</span>) &#123;</div><div class="line">            <span class="keyword">return</span> <span class="string">""</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="string">"\""</span> + obj.toString() + <span class="string">"\","</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">form</span><span class="params">()</span> </span>&#123;</div><div class="line">        StringBuilder sb = <span class="keyword">new</span> StringBuilder();</div><div class="line">        sb.append(<span class="string">"["</span>);</div><div class="line">        sb.append(wrapComma(name));</div><div class="line">        sb.append(wrapComma(age));</div><div class="line">        sb.append(wap(birth));</div><div class="line">        sb.append(<span class="string">"]"</span>);</div><div class="line">        </div><div class="line">        <span class="keyword">return</span> sb.toString();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ³¨æ„ï¼ŒwrapComma(Objet)æ¯”wrap(Object)å¤šè¿”å›ä¸€ä¸ªé€—å·ï¼Œè¿™ä¸¤ä¸ªæ–¹æ³•æ˜¯æ”¾åœ¨å¦å¤–ä¸€ä¸ªå·¥å…·ç±»é‡Œæ¥è°ƒç”¨ï¼Œè¿™é‡Œæˆ‘æ”¾åœ¨ä¸€èµ·æ–¹ä¾¿é˜…è¯»ï¼Œæœ€åform()æ–¹æ³•çš„è¿”å›çš„ä¸€èˆ¬æ ¼å¼å°±æ˜¯ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[&quot;å¼ ä¸‰&quot;, &quot;22&quot;, &quot;1990-01-01&quot;]</div></pre></td></tr></table></figure>
<p>ç”±äºè¿”å›çš„æ˜¯å¤šè¡Œï¼Œæ‰€ä»¥ç”¨å¾ªç¯æ¥å®Œæˆï¼Œä¸“é—¨å†™ä¸€ä¸ªå·¥å…·æ–¹æ³•æ¥åšè½¬æ¢ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">convertList2StringArray</span><span class="params">(List&lt;ExampleModel&gt; list)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (list == <span class="keyword">null</span> || list.size() == <span class="number">0</span>) &#123;</div><div class="line">        <span class="keyword">return</span> <span class="string">"[[]]"</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    StringBuilder sb = <span class="keyword">new</span> StringBuilder(<span class="string">"["</span>);</div><div class="line">    <span class="keyword">for</span> (ExampleModel model : list) &#123;</div><div class="line">        sb.append(model.form());</div><div class="line">        sb.append(<span class="string">","</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    sb.replace(sb.length() - <span class="number">1</span>, sb.length(), <span class="string">"]"</span>);</div><div class="line">    <span class="keyword">return</span> sb.toString();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿™æ ·ï¼Œè¿”å›çš„ç»“æœä¸€èˆ¬æ ¼å¼ä¸ºäºŒç»´æ•°ç»„å­—ç¬¦ä¸²ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[[&quot;å¼ ä¸‰&quot;, &quot;22&quot;, &quot;1990-01-01&quot;], [&quot;å¼ å››&quot;, &quot;23&quot;, &quot;1990-01-02&quot;]] æˆ–è€… [[]]</div></pre></td></tr></table></figure>
<p>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼ˆä¸æ˜¯æŒ–æ˜æœºæŠ€æœ¯å“ªå®¶å¼ºï¼‰ï¼Œé¡¹ç›®é‡ŒModelå¤šå¦‚ç‹—ï¼Œä¸€ä¸ªè¡¨æ ¼å°±å¯¹åº”ä¸€ä¸ªModelï¼Œè¿™æ ·åšæ˜¾ç„¶æ˜¯ä¸å¤Ÿï¼Œè¿™ä¸ªæ—¶å€™å¾ˆè‡ªç„¶çš„æƒ³åˆ°ï¼Œå¤šæ€å°±æ´¾ä¸Šç”¨åœºã€‚å½“ç„¶æˆ‘ä»¬ä¸ä¼šä½¿ç”¨çˆ¶ç±»ï¼Œä½¿ç”¨æ¥å£è®©Modelé‡å†™ç‰¹å®šçš„æ–¹æ³•å°±è¡Œã€‚å…ˆå®šä¹‰ä¸€ä¸ªæ¥å£ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ICommonForm</span> </span>&#123;</div><div class="line">    <span class="comment">/**</span></div><div class="line">     * è¿”å›æè¿°Modelç‰¹å®šçš„å­—ç¬¦ä¸²å½¢å¼</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">form</span><span class="params">()</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ç„¶åè®©å¯¹åº”è¦å±•ç¤ºçš„Modeléƒ½å®ç°è¿™ä¸ªæ¥å£ï¼Œä¾‹å¦‚ä¸Šé¢çš„ExampleModelã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ExampleModel</span> <span class="keyword">implements</span> <span class="title">ICommonForm</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="comment">// çœç•¥å…¶ä»–å±æ€§å’Œæ–¹æ³•</span></div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">form</span><span class="params">()</span> </span>&#123;</div><div class="line">        StringBuilder sb = <span class="keyword">new</span> StringBuilder();</div><div class="line">        sb.append(<span class="string">"["</span>);</div><div class="line">        sb.append(wrapComma(name));</div><div class="line">        sb.append(wrapComma(age));</div><div class="line">        sb.append(wrap(birth));</div><div class="line">        sb.append(<span class="string">"]"</span>);</div><div class="line">        </div><div class="line">        <span class="keyword">return</span> sb.toString();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æœ€åï¼Œå†ä¿®æ”¹ä¸‹convertList2StringArray(List)æ–¹æ³•ï¼Œä½¿ä¹‹æ›´ä¸ºé€šç”¨ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">convertList2StringArray</span><span class="params">(List&lt;? extends ICommonForm&gt; list)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (list == <span class="keyword">null</span> || list.size() == <span class="number">0</span>) &#123;</div><div class="line">        <span class="keyword">return</span> <span class="string">"[[]]"</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    StringBuilder sb = <span class="keyword">new</span> StringBuilder(<span class="string">"["</span>);</div><div class="line">    <span class="keyword">for</span> (ICommonForm model : list) &#123;</div><div class="line">        sb.append(model.form());</div><div class="line">        sb.append(<span class="string">","</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    sb.replace(sb.length() - <span class="number">1</span>, sb.length(), <span class="string">"]"</span>);</div><div class="line">    <span class="keyword">return</span> sb.toString();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ–°çš„æ–¹æ³•é‡Œï¼Œå‚æ•°å®šä¹‰å’Œforè¯­å¥å‘ç”Ÿäº†å˜åŒ–ï¼Œä¸å†æ˜¯ç‰¹å®šçš„ç±»ï¼Œåªè¦æ˜¯å®ç°äº†ICommonFormæ¥å£çš„ç±»çš„åˆ—è¡¨ï¼Œéƒ½æ˜¯åˆæ³•çš„å‚æ•°ï¼Œå’Œå‰é¢æåˆ°çš„</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> &lt;T&gt; <span class="function">List&lt;T&gt; <span class="title">doSomeThing</span><span class="params">(List&lt;T extends BaseModel&gt; list)</span></span></div></pre></td></tr></table></figure>
<p>éå¸¸ç›¸ä¼¼ã€‚<br>è®¾è®¡æ¨¡å¼é‡Œï¼Œå¾ˆå¤šæ¨¡å¼éƒ½ç”¨åˆ°äº†å¤šæ€ï¼Œå¯ä»¥ç®€åŒ–ä»£ç å’Œç»“æ„ã€‚ä¸«å†™äº†å¿«ä¸¤å¹´Javaä»£ç ï¼Œæ‰ç»ˆäºèƒ½è‡ªç„¶çš„ã€ä¸»åŠ¨çš„æƒ³åˆ°ç”¨å¤šæ€æ¥è§£å†³é—®é¢˜â€¦â€¦</p>
<h3 id="4-é‡æ„è¶…é•¿çš„switch-caseè¯­å¥ï¼ˆ2016-09-04æ›´æ–°ï¼‰"><a href="#4-é‡æ„è¶…é•¿çš„switch-caseè¯­å¥ï¼ˆ2016-09-04æ›´æ–°ï¼‰" class="headerlink" title="4 é‡æ„è¶…é•¿çš„switch-caseè¯­å¥ï¼ˆ2016-09-04æ›´æ–°ï¼‰"></a>4 é‡æ„è¶…é•¿çš„switch-caseè¯­å¥ï¼ˆ2016-09-04æ›´æ–°ï¼‰</h3><p>æœ€è¿‘é¡¹ç›®é‡Œåšä¸€ä¸ªéœ€æ±‚ï¼Œè¦å¯¹å¤šä¸ªæŒ‡æ ‡æ±‡æ€»ï¼Œä½†æ¥å£å›ºå®šï¼Œé€šè¿‡å‚æ•°åŒºåˆ†æ˜¯å“ªä¸ªæŒ‡æ ‡ï¼Œå†…éƒ¨ç”¨äº†ä¸€ä¸ªswitch-caseæ¥åˆ¤æ–­ï¼Œè¶Šåˆ°åæ¥çªç„¶å‘ç°å·²ç»æœ‰äº†12ä¸ªcaseè¯­å¥ï¼Œä»£ç æŒç»­é›†æˆä¹Ÿæ˜¾ç¤ºè¿™ä¸ªç±»æ˜¯ä¸€ä¸ªGod Classï¼Œå¦‚æ­¤çœ‹æ¥ï¼Œæ˜¯éœ€è¦é‡æ„è¿™ä¸ªswitch-caseè¯­å¥äº†ã€‚<br>æ€»ä½“æ€è·¯å°±æ˜¯å£°æ˜ä¸€ä¸ªæŠ½è±¡çˆ¶ç±»ï¼Œæ·»åŠ æŠ½è±¡æ–¹æ³•å’Œä¸€äº›å…¬å…±çš„æˆå‘˜ï¼Œè®©å­ç±»æ¥ç»§æ‰¿å¹¶é‡å†™æ–¹æ³•ã€‚ä¸šåŠ¡é€»è¾‘é‡ŒæŠŠæŒ‡æ ‡ï¼ˆæšä¸¾ï¼‰åškeyï¼Œå­ç±»å®ä¾‹åšvalueï¼Œæ”¾åœ¨mapå¯¹è±¡é‡Œã€‚è¿™æ ·è°ƒç”¨æ—¶é€šè¿‡æŒ‡æ ‡è·å–å­ç±»å®ä¾‹ï¼Œç„¶åä¼ å…¥å‚æ•°ä¸€é€šæ“ä½œå°±å¯ä»¥äº†ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Parent</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">int</span> <span class="title">apply</span><span class="params">()</span></span>;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Parent</span><span class="params">(String value)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.name = value;</div><div class="line">    &#125;</div><div class="line">    <span class="comment">// get() set()</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Child01</span> <span class="keyword">extends</span> <span class="title">Parent</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Child01</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">apply</span><span class="params">(String p1, String p2)</span> </span>&#123;</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            <span class="keyword">int</span> ints = ...</div><div class="line">            <span class="keyword">return</span> ints;</div><div class="line">        &#125; <span class="keyword">catch</span> (NumberFormatException e) &#123;</div><div class="line">            <span class="comment">// log</span></div><div class="line">            <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// å…¶ä»–å­ç±»ç±»ä¼¼ï¼Œç»§æ‰¿Parentï¼Œå®ç°è‡ªå·±çš„é€»è¾‘</span></div></pre></td></tr></table></figure>
<p>åœ¨ä¸šåŠ¡é€»è¾‘é‡Œï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">private</span> Map&lt;EnumType, Parent&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</div><div class="line"><span class="keyword">static</span> &#123;</div><div class="line">    map.put(EnumType.TYPE1, <span class="keyword">new</span> Child01());</div><div class="line">    map.put(EnumType.TYPE2, <span class="keyword">new</span> Child02());</div><div class="line">    <span class="comment">// ...</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getResultByType</span><span class="params">(EnumType type, String param1, String param2)</span> </span>&#123;</div><div class="line">    Optional&lt;Parent&gt; op = Optional.fromNullable(map.get(type)) <span class="comment">// Guava Optional</span></div><div class="line">    <span class="keyword">if</span> (op.isPresent()) &#123;</div><div class="line">        <span class="keyword">return</span> op.get().apply(param1, param2);</div><div class="line">    &#125; </div><div class="line">    <span class="keyword">else</span> &#123;</div><div class="line">        <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>è¿™æ ·ï¼Œä¸šåŠ¡é€»è¾‘é‡Œè¿è¡Œæ—¶ç»‘å®šï¼Œé€šè¿‡ä¸åŒæšä¸¾è·å–ä¸åŒå®ä¾‹ï¼Œå†è°ƒç”¨applyæ–¹æ³•ï¼Œå¤šæ€çš„åˆä¸€æ¬¡åº”ç”¨ï¼Œå…·ä½“çš„ä¸šåŠ¡å¤„ç†æ”¾åˆ°äº†å…·ä½“çš„å­ç±»ä¸­ï¼Œæ•´ä¸ªä»£ç ç»“æ„ä¹Ÿå˜å¾—æ¸…æ™°äº†å¾ˆå¤šã€‚ï¼ˆä½†æ˜¯ç±»çš„æ•°é‡çˆ†ç‚¸äº†è¯¶ğŸ’¥ï¼‰</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2016-04-17T06:09:16.000Z"><a href="/2016/04/17/add-env-var-on-OSX-md/">2016-04-17</a></time>
      
      
  
    <h1 class="title"><a href="/2016/04/17/add-env-var-on-OSX-md/">åœ¨OS Xä¸Šæ·»åŠ ç¯å¢ƒå˜é‡</a></h1>
  

    </header>
    <div class="entry">
      
        <p>åœ¨ Windows ä¸Šæ·»åŠ ç¯å¢ƒå˜é‡çš„æ“ä½œéƒ½å¾ˆç†Ÿæ‚‰äº†ã€‚ä½†æ˜¯åœ¨ OSX ä¸Šè¿˜æ˜¯å¾ˆç”Ÿç–ï¼Œä¸Šæ¬¡åœ¨ OSX ä¸Šæ·»åŠ ç¯å¢ƒå˜é‡ï¼Œè¿˜æ˜¯åœ¨åˆšä¹°ç¬”è®°æœ¬ï¼Œæ·»åŠ  Java ç¯å¢ƒå˜é‡ï¼Œå½“æ—¶æ·»åŠ å®Œäº†ï¼Œèµ·ä½œç”¨åå°±æ²¡ç®¡äº†ï¼Œä»Šå¤©åˆè¦æ·»åŠ  Scala ç¯å¢ƒå˜é‡æ—¶ï¼ŒåŸºæœ¬å¿˜äº†æ€ä¹ˆå¼„ï¼Œç°åœ¨æŠŠæ•´ä¸ªè¿‡ç¨‹è®°ä¸‹æ¥ã€‚   </p>
<p>OSX ä¸Šæ·»åŠ ç¯å¢ƒå˜é‡çš„ç¬¬ä¸€ä¸ªåœ°æ–¹ï¼š<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ /etc/profile</div></pre></td></tr></table></figure></p>
<p>è¿™æ˜¯å…¨å±€å…¬æœ‰é…ç½®ï¼Œä¸ç®¡å“ªä¸ªç”¨æˆ·ç™»å½•ï¼Œéƒ½ä¼šè¯»å–è¯¥æ–‡ä»¶ã€‚æ‰€ä»¥ä¸å»ºè®®åœ¨è¿™ä¸ªæ–‡ä»¶é‡Œæ·»åŠ ã€‚</p>
<p>ç¬¬äºŒä¸ªåœ°æ–¹ï¼š<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ /etc/bashrc</div></pre></td></tr></table></figure></p>
<p>ä¹Ÿæ˜¯å…¨å±€å…¬æœ‰é…ç½®ï¼Œä¸€èˆ¬åœ¨é‡Œé¢æ·»åŠ ç³»ç»Ÿçº§ç¯å¢ƒå˜é‡ï¼Œæ‰§è¡Œ bash shell æ—¶ï¼Œä¼šè¯»å–è¯¥æ–‡ä»¶ã€‚</p>
<p>ç¬¬ä¸‰ä¸ªåœ°æ–¹ï¼Œbash_profileï¼š<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ ~/.bash_profile</div></pre></td></tr></table></figure></p>
<p>å¦‚æœè¯¥æ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ›å»ºè¯¥æ–‡ä»¶å³å¯ï¼Œç„¶åå¾€é‡Œé¢å†™å…¥ç¯å¢ƒå˜é‡å€¼ã€‚å½“çœ‹åˆ° bash_profile è¿™ä¸ªæ–‡ä»¶æ—¶ï¼Œçªç„¶æƒ³èµ·å½“åˆé… Java ç¯å¢ƒå˜é‡å¥½åƒå·²ç»å»ºå¥½äº†è¿™ä¸ªæ–‡ä»¶ï¼Œè¾“å…¥ä¸‹é¢å‘½ä»¤æ‰“å¼€ä¸€çœ‹æœç„¶æœ‰ Java çš„ç¯å¢ƒå˜é‡é…ç½®ã€‚é…ç½®è¿‡ç¨‹å¦‚ä¸‹ã€‚<br>è¾“å…¥å¦‚ä¸‹å‘½ä»¤åï¼ŒæŒ‰ä¸‹ <kbd>i</kbd> é”®ï¼Œè¿›å…¥ç¼–è¾‘æ¨¡å¼ï¼š<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ vim ~/.bash_profile</div></pre></td></tr></table></figure></p>
<p>æ·»åŠ ç¯å¢ƒå˜é‡å¯¹åº”çš„è·¯å¾„ï¼Œä¾‹å¦‚ï¼Œéœ€è¦æ·»åŠ  Scala ç¯å¢ƒå˜é‡è·¯å¾„ï¼Œåœ¨æ–‡ä»¶æœ€åå†™å…¥ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">export PATH=&quot;$PATH:/usr/local/scala-path/bin&quot;</div></pre></td></tr></table></figure></p>
<p>å…¶ä¸­ï¼Œscala-path æ˜¯ä»å®˜ç½‘ä¸‹è½½ä¸‹æ¥çš„è§£å‹åçš„æ–‡ä»¶å¤¹ï¼Œæ”¾åœ¨ /usr/local/ç›®å½•ä¸‹ã€‚å®ŒæˆåæŒ‰ <kbd>esc</kbd> é”®ï¼Œè¿›å…¥æ™®é€šæ¨¡å¼ï¼Œè¾“å…¥å¦‚ä¸‹å‘½ä»¤ä¿å­˜å¹¶é€€å‡ºï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">:wq</div></pre></td></tr></table></figure>
<p>æ­¤æ—¶é‡å¯ç»ˆç«¯ï¼Œè¾“å…¥ Scalaï¼Œå°±è¿›å…¥äº† Scala çš„å‘½ä»¤æ¨¡å¼ã€‚æ­¤æ—¶ä¼šè¾“å‡ºç±»ä¼¼å¦‚ä¸‹ä¿¡æ¯ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Welcome to Scala 2.11.8 (Java HotSpot(TM) 64-Bit Server VM, Java 1.8.0).</div><div class="line">Type in expressions for evaluation. Or try :help.</div></pre></td></tr></table></figure></p>
<p>å¦‚æœè¦é€€å‡º Scala å‘½ä»¤æ¨¡å¼ï¼Œè¾“å…¥ï¼š<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">:q  æˆ–è€…  :quit</div></pre></td></tr></table></figure></p>
<p>æ•´ä¸ªè¿‡ç¨‹è¿˜æ˜¯å¾ˆç®€å•çš„ã€‚:)</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2016-04-10T06:01:39.000Z"><a href="/2016/04/10/a-simple-python-spider-md/">2016-04-10</a></time>
      
      
  
    <h1 class="title"><a href="/2016/04/10/a-simple-python-spider-md/">ä¸€ä¸ªç®€å•çš„Pythonçˆ¬è™«</a></h1>
  

    </header>
    <div class="entry">
      
        <p>ç”±äºæˆ‘ç»å¸¸é€›å¾®åšï¼Œçœ‹åˆ°æŸäº›åšä¸»çš„å›¾ç‰‡éƒ½å¾ˆå¥½çœ‹ï¼ˆä½ æ‡‚çš„ï¼‰ï¼Œå°±æƒ³å¹²è„†ä¸‹è½½åˆ°æœ¬åœ°ï¼Œäºæ˜¯èŒç”Ÿäº†æä¸ªçˆ¬è™«çš„æƒ³æ³•ã€‚ä¹‹å‰å¬è¯´ Python ç½‘ç»œçˆ¬è™«ï¼Œå¬èµ·æ¥é«˜å¤§ä¸Šï¼Œåœ¨å®è·µäº†åæ„Ÿè§‰ä¹Ÿä¸æ˜¯ä»€ä¹ˆéš¾äº‹ï¼Œç°åœ¨æ¥çœ‹è‡ªå·±å®ç°çš„çˆ¬è™«éƒ½å¾ˆç®€å•ï¼Œä»¥åè¦å®ç°æ›´å¤æ‚çš„çˆ¬è™«çš„è¯ï¼Œçœ‹äº†è¿™ç¯‡åšå®¢å’Œä»£ç ï¼Œèƒ½è®©è‡ªå·±ä¹Ÿèƒ½å¿«é€Ÿçš„æ¡èµ·æ¥ï¼Œè¿›è¡ŒäºŒæ¬¡å¼€å‘ã€‚</p>
<p>é™¤äº†éœ€è¦ Python ç¯å¢ƒå¤–ï¼Œè¿˜éœ€è¦å®‰è£… requestsã€BeautifulSoup4ç­‰ã€‚è·å–å¾®åšé¡µé¢å†…å®¹æ—¶ä½¿ç”¨cookieçš„æ–¹å¼ï¼Œè¿™æ ·ä¸éœ€è¦ç”¨æˆ·åå’Œå¯†ç å°±å¯ä»¥è¯·æ±‚åˆ°å¾®åšã€‚<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ pip install requests BeautifulSoup4</div></pre></td></tr></table></figure></p>
<p>å¥½äº†ï¼Œå‡†å¤‡å·¥ä½œåŸºæœ¬OKã€‚è¿™ä¸ªçˆ¬è™«æ˜¯ä»æ–°æµªå¾®åšä¸Šçˆ¬å–æŸä¸ªåšä¸»çš„æ‰€æœ‰å›¾ç‰‡ï¼Œåœ¨è§‚å¯Ÿäº†æ–°æµªå¾®åšé‡Œå›¾ç‰‡URLçš„è§„å¾‹åï¼Œå‘ç°é“¾æ¥ä¸»è¦æœ‰3éƒ¨åˆ†æ„æˆï¼Œå¦‚ä¸‹ã€‚img-key éƒ¨åˆ†æˆ‘ä¼°è®¡æ˜¯å­˜å–å›¾ç‰‡çš„å”¯ä¸€IDå€¼ï¼Œpart2 å–ä¸åŒçš„å€¼ï¼Œä¼šå¾—åˆ°ä¸åŒå°ºå¯¸çš„å›¾ç‰‡ï¼Œæœ€å¤§å°ºå¯¸æ—¶ï¼Œpart2å–å€¼ â€˜largeâ€™ï¼Œæœ‰äº†è¿™ä¸ªè§„å¾‹å°±å¥½åŠäº†ï¼Œå°†é¡µé¢æ‰€æœ‰å›¾ç‰‡æ»¡è¶³3æ®µå¼çš„é“¾æ¥ä¸­é—´é‚£éƒ¨åˆ†æ›¿æ¢æˆâ€™largeâ€™ï¼Œå†ä¸‹è½½å›¾ç‰‡å³å¯ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://ww2.sinaimg.cn/part2/img-key.jpg</div></pre></td></tr></table></figure>
<p>å¦å¤–ï¼Œç”±äºä½¿ç”¨çš„æ˜¯ <em>weibo.cn</em> åŸŸåï¼Œä»æµè§ˆå™¨é‡Œå¾—åˆ°æ˜¯ä¸€å¼ å›¾ç‰‡å’Œä¸€ä¸ª<strong>æ›´å¤š</strong>ä½œä¸ºé“¾æ¥ï¼Œç‚¹äº†é“¾æ¥æ‰çœ‹å¾—åˆ°æ‰€æœ‰å›¾ç‰‡ï¼Œæ‰€ä»¥çˆ¬æ¯ä¸ªé¡µé¢æœ‰ä¸ªäºŒæ¬¡è¯·æ±‚ï¼Œå°†æ›´å¤šçš„å›¾ç‰‡ä¸‹è½½ä¸‹æ¥ã€‚ä¸ºäº†é¿å…é‡å¤ä¸‹è½½å¯¼è‡´å›¾ç‰‡éš¾ä»¥ç»´æŠ¤ï¼Œä¿å­˜å›¾ç‰‡æ—¶ï¼Œå°†å¾®åšçš„å‘å¸ƒæ—¥æœŸå’Œå›¾ç‰‡é“¾æ¥çš„MD5å€¼ç»„åˆæˆå›¾ç‰‡åç§°ï¼Œè¿™æ ·ä¸‹è½½åˆ°æœ¬åœ°åï¼Œå›¾ç‰‡ä¼šä»¥åœ¨å¾®åšä¸Šå‘å¸ƒçš„æ—¥æœŸæ’åºï¼ŒåŒæ—¶ï¼Œå†æ¬¡è¿è¡Œçˆ¬è™«æ—¶ï¼Œå°†å›¾ç‰‡åç§°ååŠæˆªçš„MD5å€¼æå–å‡ºæ¥ï¼Œåœ¨ä¸‹è½½æ—¶å€™å¯¹æ¯”è¯¥å›¾ç‰‡çš„é“¾æ¥MD5å€¼æ˜¯å¦å·²ç»å­˜åœ¨ï¼Œé¿å…é‡å¤ä¸‹è½½ã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸‹è½½ä¸€ä¸ªé¡µé¢é‡Œæ‰€æœ‰å›¾ç‰‡çš„å‡½æ•°ä»£ç ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">download_one_page</span><span class="params">(soup, user_id, exists)</span>:</span></div><div class="line"><span class="string">"""</span></div><div class="line">download all pictures on the website</div><div class="line">:param soup: web page soup</div><div class="line">:param user_id: the weibo user id</div><div class="line">:param exists exists pic names</div><div class="line">:return: find weibo divs, return True, else False</div><div class="line">"""</div><div class="line"></div><div class="line"><span class="comment"># ten weibo div in every page</span></div><div class="line">divs = soup.find_all(div_filter_func)</div><div class="line"></div><div class="line"><span class="keyword">if</span> <span class="keyword">not</span> divs:</div><div class="line">    <span class="keyword">return</span> <span class="keyword">False</span></div><div class="line"></div><div class="line"><span class="keyword">for</span> div <span class="keyword">in</span> divs:</div><div class="line">    spans = div.find_all(<span class="string">'span'</span>)</div><div class="line">    wb_post_time = get_weibo_post_time(spans[<span class="number">1</span>].text)</div><div class="line"></div><div class="line">    <span class="comment"># abstract a link</span></div><div class="line">    all_img = div.find_all(<span class="string">'img'</span>)</div><div class="line">    img_link = filter(<span class="keyword">lambda</span> x: x.endswith(<span class="string">'.jpg'</span>), [all_img[<span class="number">0</span>].get(<span class="string">'src'</span>)] <span class="keyword">if</span> all_img <span class="keyword">else</span> [])</div><div class="line"></div><div class="line">    <span class="comment"># abstract more links</span></div><div class="line">    more_links = [link[<span class="string">'href'</span>] <span class="keyword">for</span> link <span class="keyword">in</span> div.find_all(<span class="string">'a'</span>) <span class="keyword">if</span> link.get(<span class="string">'href'</span>) <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span>]</div><div class="line">    more_links_real = [x <span class="keyword">for</span> x <span class="keyword">in</span> more_links <span class="keyword">if</span> <span class="string">'picAll'</span> <span class="keyword">in</span> x]</div><div class="line">    <span class="keyword">if</span> more_links_real:</div><div class="line">        more_content = requests.get(more_links_real[<span class="number">0</span>], cookies = get_cookie())</div><div class="line">        more_soup = BeautifulSoup(more_content.content, <span class="string">'html.parser'</span>)</div><div class="line">        more_soup_urls = get_more_page_image_url(more_soup)</div><div class="line">        img_link = more_soup_urls <span class="keyword">if</span> more_soup_urls <span class="keyword">else</span> img_link</div><div class="line"></div><div class="line">    <span class="comment"># download</span></div><div class="line">    <span class="keyword">for</span> idx, link <span class="keyword">in</span> enumerate(img_link):</div><div class="line">        md5 = calculate_md5(link)</div><div class="line">        <span class="keyword">if</span> md5 <span class="keyword">not</span> <span class="keyword">in</span> exists:</div><div class="line">            large_link = replace_part2_in_link(link)</div><div class="line">            image_content = requests.get(large_link, cookies = get_cookie())</div><div class="line"></div><div class="line">            image_name = <span class="string">"&#123;&#125;&gt;&#123;&#125;_&#123;&#125;"</span>.format(wb_post_time, str(idx), md5)</div><div class="line">            <span class="keyword">with</span> open(<span class="string">'./downloads/&#123;&#125;/&#123;&#125;.jpg'</span>.format(user_id, image_name), <span class="string">'wb'</span>) <span class="keyword">as</span> jpg:</div><div class="line">                jpg.write(image_content.content)</div><div class="line"></div><div class="line">                exists.add(image_name)</div><div class="line">                print(<span class="string">'download'</span>, large_link, image_name, datetime.datetime.now())</div><div class="line">                time.sleep(random.random())</div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            print(<span class="string">'jump over:'</span>, link)</div><div class="line"></div><div class="line">sleep = <span class="number">8</span> * random.random()</div><div class="line">print(<span class="string">'sleep'</span>, sleep, <span class="string">'seconds'</span>)</div><div class="line">time.sleep(sleep)</div><div class="line"><span class="keyword">return</span> <span class="keyword">True</span></div></pre></td></tr></table></figure>
<p>åœ¨æŸæ¬¡æ‰“ç®—çˆ¬å–å¤§é‡æŸä¸ªåšä¸»çš„å›¾ç‰‡æ—¶ï¼Œå‡ºç°äº†è¯·æ±‚å¤±è´¥ï¼ŒæŸ¥äº†èµ„æ–™å‘ç°æ˜¯ç½‘ç«™æœ‰åçˆ¬è™«åŠŸèƒ½ï¼Œäºæ˜¯ä½¿ç”¨äº†ä¸€äº›ç®€å•çš„ç­–ç•¥ï¼Œæ¯”å¦‚è¯·æ±‚åŠ ä¸Šå¤´æ¶ˆæ¯ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">header = &#123;</div><div class="line">      <span class="string">'User-Agent'</span>: <span class="string">'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/49.0.2623.112 Safari/537.36'</span>,</div><div class="line">      <span class="string">'Accept'</span>: <span class="string">'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8'</span>,</div><div class="line">      <span class="string">'Accept-Language'</span>: <span class="string">'zh-CN,zh;q=0.8,en;q=0.6'</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>é™¤æ­¤ä¹‹å¤–ï¼Œå¯¹è¯·æ±‚çš„cookieä¹Ÿåœ¨æœ«å°¾æ·»åŠ éšæœºæ•°ï¼Œæ¯æ¬¡ç”¨ä¸åŒçš„cookieå»è¯·æ±‚ï¼Œå¹¶ä¸”ï¼Œæ¯çˆ¬å–å®Œä¸€ä¸ªé¡µé¢çš„å†…å®¹ï¼Œéšæœºä¼‘çœ 0-8ç§’ï¼Œè¿™æ ·åšè™½ç„¶æŠ“å–é€Ÿåº¦æ…¢äº†ç‚¹ï¼Œä½†è‡³å°‘èƒ½ä¿è¯æ¯æ¬¡æŠ“å–ä¸ä¼šåŠé€”æŠ¥é”™ã€‚</p>
<p>å®Œæ•´çš„ä»£ç ç¤ºä¾‹<a href="https://github.com/hsqs/spiders/blob/master/weibo/weibo_miner.py" target="_blank" rel="external">ç‚¹è¿™é‡Œ</a>ã€‚    </p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2016-03-27T05:53:45.000Z"><a href="/2016/03/27/use-virtualenv-md/">2016-03-27</a></time>
      
      
  
    <h1 class="title"><a href="/2016/03/27/use-virtualenv-md/">åœ¨OS Xä¸Šä½¿ç”¨virtualenv</a></h1>
  

    </header>
    <div class="entry">
      
        <h3 id="1ï¼Œç†è§£virtualenv"><a href="#1ï¼Œç†è§£virtualenv" class="headerlink" title="1ï¼Œç†è§£virtualenv"></a>1ï¼Œç†è§£virtualenv</h3><p>virtualenvä»å­—é¢æ„æ€æ¥ç†è§£çš„è¯ï¼Œå°±æ˜¯è™šæ‹Ÿç¯å¢ƒçš„æ„æ€ï¼Œè¿™ä¸ªç¬¬ä¸€å°è±¡å®¹æ˜“å¯¹æˆ‘ä»¬äº§ç”Ÿè¯¯å¯¼ï¼Œå…¶å®å¹¶ä¸æ˜¯è™šæ‹Ÿç¯å¢ƒï¼Œä»¥æˆ‘çš„ç†è§£æ˜¯ä¸€ä¸ª<strong>ç‹¬ç«‹</strong>ç¯å¢ƒã€‚ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿå¥½æ¯”ä¸€å°ç”µè„‘ä¸Šè£…å¥½Pythonä»¥åï¼Œå¯ä»¥æŠŠå®‰è£…çš„Pythonæ‹·è´åˆ°å¦ä¸€ä¸ªç›®å½•(å®˜æ–¹:å…¶å®å¹¶æ²¡æœ‰çœŸæ­£å®‰è£…å¤šä¸ª Python å‰¯æœ¬ï¼Œä½†æ˜¯å®ƒç¡®å®æä¾›äº†ä¸€ç§å·§å¦™çš„æ–¹å¼æ¥è®©å„é¡¹ç›®ç¯å¢ƒä¿æŒç‹¬ç«‹)ï¼Œè¿™æ ·ä¸¤ä¸ªPythonç¯å¢ƒç›¸äº’ç‹¬ç«‹ï¼Œäº’ä¸å½±å“ï¼Œé‚£æœ‰äº†å¤šä¸ªPythonç¯å¢ƒï¼Œåœ¨ä»€ä¹ˆæ—¶å€™å¯ç”¨è°ç¦ç”¨è°å‘¢ï¼Ÿvirtualenvè¿™ä¸ªæ—¶å€™å°±æ´¾ä¸Šç”¨åœºäº†ã€‚å®˜æ–¹å¯¹virtualenvçš„è§£é‡Šï¼š<a href="https://virtualenv.pypa.io/" target="_blank" rel="external">virtualenv is a tool to create isolated Python environments</a>.</p>
<h3 id="2ï¼Œå®‰è£…virtualenv"><a href="#2ï¼Œå®‰è£…virtualenv" class="headerlink" title="2ï¼Œå®‰è£…virtualenv"></a>2ï¼Œå®‰è£…virtualenv</h3><p>å®‰è£…å°±å¤ªç®€å•äº†ï¼Œä½¿ç”¨pipå®‰è£…å³å¯ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ pip install virtualenv</div></pre></td></tr></table></figure>
<p>å¦‚æœæœ‰æƒé™é—®é¢˜ï¼Œå‰é¢åŠ ä¸€ä¸ªsudo</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ sudo pip install virtualenv</div></pre></td></tr></table></figure>
<h3 id="3ï¼Œä½¿ç”¨virtualenv"><a href="#3ï¼Œä½¿ç”¨virtualenv" class="headerlink" title="3ï¼Œä½¿ç”¨virtualenv"></a>3ï¼Œä½¿ç”¨virtualenv</h3><p>é¦–å…ˆæ‰¾åˆ°ä¸€ä¸ªåˆé€‚çš„ç©ºæ–‡ä»¶å¤¹ï¼Œåœ¨ç»ˆç«¯é‡Œè¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼Œåˆ›å»ºä¸€ä¸ªè™šæ‹Ÿç¯å¢ƒï¼ˆPythonå·²ç»å®‰è£…åˆ°ç”µè„‘ä¸Šï¼‰ï¼š</p>
<pre><code>$ virtualenv [-p python3] dir-name
</code></pre><p>å¦‚æœç”µè„‘ä¸Šå®‰è£…äº†å¤šä¸ªç‰ˆæœ¬çš„Pythonï¼Œé»˜è®¤ä¼šä½¿ç”¨OS Xè‡ªå¸¦çš„2.7ç‰ˆæœ¬ï¼Œå¦‚æœæƒ³åˆ›å»º3.0ä»¥ä¸Šçš„ç‰ˆæœ¬çš„è¯ï¼ŒæŒ‡å®šç‰ˆæœ¬å‚æ•°å³å¯ã€‚è¾“å…¥å®Œæˆå›è½¦ï¼Œå¯ä»¥åˆ°Finderé‡ŒæŸ¥çœ‹ç›®å½•dir-nameï¼Œé‡Œé¢æœ‰binã€includeã€libä¸‰ä¸ªç›®å½•ã€‚æœ€åä¸€æ­¥ï¼Œç»§ç»­åœ¨ç»ˆç«¯é‡Œè¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼Œæ¿€æ´»è¿™ä¸ªåˆšåˆšåˆ›å»ºçš„ç¯å¢ƒï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ <span class="built_in">source</span> dir-name/bin/activate</div></pre></td></tr></table></figure>
<p>è¿™ä¸ªæ—¶å€™ï¼Œå½“å‰Pythonç¯å¢ƒå°±æ¿€æ´»äº†ï¼Œç»ˆç«¯ä¹Ÿä¼šæœ‰ç›¸åº”çš„å˜åŒ–ï¼Œåœ¨æœ€å‰é¢ä¼šå‡ºç°å½“å‰ç¯å¢ƒçš„åå­—ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">(dir-name)your-computer-name $:</div></pre></td></tr></table></figure>
<p>hahï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥ä½¿ç”¨äº†ï¼Œæ¯”å¦‚åœ¨è¿™ä¸ªè€Œç¯å¢ƒé‡Œå¼€å‘Flaskåº”ç”¨ï¼Œæ‰§è¡Œï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ pip install Flask</div></pre></td></tr></table></figure>
<p>æ­¤æ—¶ï¼ŒFlaskä¼šå®‰è£…åœ¨dir-nameé‡Œï¼Œè€Œä¸ä¼šå®‰è£…åœ¨å…¶ä»–ç¯å¢ƒï¼Œè¿™æ ·å°±è¾¾åˆ°äº†isolatedçš„æ•ˆæœã€‚å¦‚æœä¸å†ä½¿ç”¨å½“å‰ç¯å¢ƒï¼Œä½¿ç”¨å¦‚ä¸‹å‘½ä»¤å³å¯é€€å‡ºï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ deactivate</div></pre></td></tr></table></figure>
<h3 id="4ï¼Œåˆ é™¤virtualenv"><a href="#4ï¼Œåˆ é™¤virtualenv" class="headerlink" title="4ï¼Œåˆ é™¤virtualenv"></a>4ï¼Œåˆ é™¤virtualenv</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ rmvirtualenv env-name</div></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-12-27T05:36:04.000Z"><a href="/2015/12/27/some-usage-of-mybatis-md/">2015-12-27</a></time>
      
      
  
    <h1 class="title"><a href="/2015/12/27/some-usage-of-mybatis-md/">Mybatisä½¿ç”¨ç»éªŒæ€»ç»“</a></h1>
  

    </header>
    <div class="entry">
      
        <p>Mybatiså‰ååœ¨é¡¹ç›®é‡Œä¸€å…±ç”¨äº†å¤§æ¦‚1å¹´æ—¶é—´ï¼Œå½“æ—¶ä¸ºäº†èµ¶è¿›åº¦ï¼Œåªå­¦äº†äº›åŸºæœ¬çš„ç”¨æ³•ï¼Œåæ¥æ…¢æ…¢ç§¯ç´¯äº†ä¸€äº›å°æŠ€å·§ï¼Œå…¶å®è¿™äº›éƒ½åœ¨å®˜æ–¹æ–‡æ¡£é‡Œéƒ½æœ‰è¯´æ˜ï¼Œåªæ˜¯è‡ªå·±ç”¨åˆ°è€Œå·²ã€‚</p>
<h3 id="1ã€foreach-inçµæ´»ä½¿ç”¨"><a href="#1ã€foreach-inçµæ´»ä½¿ç”¨" class="headerlink" title="1ã€foreach-inçµæ´»ä½¿ç”¨"></a>1ã€foreach-inçµæ´»ä½¿ç”¨</h3><p>åœ¨ä½¿ç”¨ foreach æ ‡ç­¾æ—¶ï¼Œé€šå¸¸ç”¨äºæ„å»º IN å­æŸ¥è¯¢æˆ–æ’å…¥æ•°æ®è¯­å¥ï¼Œæ„å»º IN è¯­å¥çš„è¯­æ³•å¦‚ä¸‹ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">"list"</span> <span class="attr">item</span>=<span class="string">"m"</span> <span class="attr">open</span>=<span class="string">"("</span> <span class="attr">separator</span>=<span class="string">","</span> <span class="attr">close</span>=<span class="string">")"</span>&gt;</span></div><div class="line">    #&#123;m&#125;</div><div class="line"><span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></div></pre></td></tr></table></figure>
<p>foreach çš„å„é¡¹å‚æ•°å°±ä¸ç”¨å¤šè§£é‡Šäº†ï¼Œè¿™é‡Œï¼Œopen å’Œ close éƒ½æ˜¾ç¤ºçš„å†™åˆ°äº†foreachæ ‡ç­¾é‡Œã€‚åŒç†ï¼Œå½“æ„å»ºæ’å…¥å¤šæ¡æ•°æ®çš„è¯­å¥æ—¶ï¼ŒåŒæ ·çš„è¯­æ³•ï¼Œä¸è¿‡ç¨æœ‰ç‚¹å˜åŒ–ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">"list"</span> <span class="attr">item</span>=<span class="string">"m"</span> <span class="attr">separator</span>=<span class="string">","</span>&gt;</span></div><div class="line">    (#&#123;m.id&#125;, #&#123;m.name&#125;)</div><div class="line"><span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></div></pre></td></tr></table></figure>
<p>æ³¨æ„ï¼Œforeach é‡Œçš„è¯­å¥æ˜¯å¸¦äº†åœ†æ‹¬å·ï¼Œå»æ‰äº† open å’Œ close å±æ€§ï¼Œåˆ†éš”ç¬¦ä¾æ—§æ˜¯,ï¼Œè¿™æ˜¯å…¶ä¸­ä¸€ç§å¯¹ values åé¢ SQL çš„ä¸€ç§åˆ†è§£æ–¹å¼ï¼Œæˆ–è€…ç”¨ä¸‹é¢è¿™ç§ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">"list"</span> <span class="attr">item</span>=<span class="string">"m"</span> <span class="attr">open</span>=<span class="string">"("</span> <span class="attr">separator</span>=<span class="string">"),("</span> <span class="attr">close</span>=<span class="string">")"</span>&gt;</span></div><div class="line">    #&#123;m.id&#125;, #&#123;m.name&#125;</div><div class="line"><span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></div></pre></td></tr></table></figure>
<p>è¿™é‡Œå”¯ä¸€æ³¨æ„çš„æ˜¯ separator çš„å˜åŒ–ï¼Œè¿™ä¸¤ç§æ’å…¥æ•°æ®æ—¶çš„å†™æ³•ï¼Œæ•ˆæœéƒ½æ˜¯ä¸€è‡´çš„ã€‚æƒ³åˆ°è¿™é‡Œï¼Œseparator å¯ä»¥æ˜¯å¤šä¸ªå­—ç¬¦ï¼Œç”šè‡³æ˜¯SQLè¯­å¥çš„ä¸€éƒ¨åˆ†ï¼Œæ€ä¹ˆä½¿ç”¨å°±çœ‹ä¸šåŠ¡åœºæ™¯äº†ã€‚</p>
<h3 id="2ã€SQL-æ³¨è§£"><a href="#2ã€SQL-æ³¨è§£" class="headerlink" title="2ã€SQL æ³¨è§£"></a>2ã€SQL æ³¨è§£</h3><p>å¯¹äºæ¯”è¾ƒç®€å•çš„ä¸€ä¸¤è¡Œçš„ SQLï¼Œå¯ä»¥ä¸ç”¨åœ¨ mapper æ–‡ä»¶é‡Œå†™é…ç½®ï¼Œç›´æ¥åœ¨Javaä»£ç é‡Œæ·»åŠ æ³¨è§£çš„æ–¹å¼æ¥å®ç°ã€‚è¿™æ ·åšè¿˜æœ‰ä¸€ä¸ªå°±æ˜¯åœ¨è°ƒè¯•çš„æ—¶å€™ï¼Œå¯ä»¥ä¸ç”¨å†å»æ‰¾ xml æ–‡ä»¶é‡Œçš„ SQL ä»£ç ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Select</span>(<span class="string">"SELECT name FROM user WHERE province_id = #&#123;address&#125; AND gender = #&#123;gender&#125;"</span>)</div><div class="line"><span class="function"><span class="keyword">public</span> List&lt;String&gt; <span class="title">selectName</span><span class="params">(@Param(<span class="string">"address"</span>)</span>Integer address, @<span class="title">Param</span><span class="params">(<span class="string">"gender"</span>)</span><span class="keyword">char</span> gender)</span>;</div></pre></td></tr></table></figure>
<p>é™¤äº†@Select æ³¨è§£ï¼Œè¿˜æœ‰@Insertã€@Updateã€@Deleteï¼Œä½¿ç”¨æ–¹æ³•åŒä¸Šã€‚è¿™æ ·SQLå’ŒJavaä»£ç æ”¾åœ¨ä¸€èµ·ï¼Œ<br>æŸ¥çœ‹èµ·æ¥éå¸¸çš„æ–¹ä¾¿ã€‚</p>
<h3 id="3ã€æ³¨è§£å‚æ•°"><a href="#3ã€æ³¨è§£å‚æ•°" class="headerlink" title="3ã€æ³¨è§£å‚æ•°"></a>3ã€æ³¨è§£å‚æ•°</h3><p>åœ¨ä¼ å…¥å¤šä¸ªå‚æ•°åˆ° Mybatis çš„æ—¶å€™ï¼Œå¯ä»¥ç”¨Listã€Mapä¼ é€’ï¼Œå¯¹äºMapè¿™ç§æƒ…å†µæ¯”è¾ƒéº»çƒ¦ï¼Œé¦–å…ˆè¦ä¸“é—¨æ„é€ ä¸€ä¸ªMapï¼Œå¦å¤–æœ€éš¾ä»¥å¿å—çš„æ˜¯ç”¨Mapä¼ å¤šä¸ªå‚æ•°ä¸çŸ¥é“é‡Œé¢åˆ°åº•æœ‰ä»€ä¹ˆå†…å®¹ï¼Œåªæœ‰åˆ°æ‰§è¡ŒSQLæ—¶æ‰ä¼šæŠ¥å‡ºé—®é¢˜ï¼Œç»´æŠ¤èµ·æ¥ä¹Ÿæä¸ºéº»çƒ¦ã€‚<br>è¿™é‡Œå¯ä»¥ä½¿ç”¨å‚æ•°æ³¨è§£ï¼Œçœå»è¿™ä¸€å †æ­¥éª¤ã€‚åŒæ—¶ï¼Œç›´è§‚çš„å±•ç¤ºæœ‰å“ªäº›å˜é‡ä¼ å…¥SQLï¼Œè¿™æ ·è°ƒç”¨æ¥å£ä¼ å‚æ•°å°±å¯ä»¥äº†ï¼Œè°ƒç”¨è€…ä¸ç”¨å…³å¿ƒ SQL é‡Œå‚æ•°ç”¨çš„æ˜¯å“ªä¸ªåå­—ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> List&lt;String&gt; <span class="title">selectName</span><span class="params">(@Param(<span class="string">"address"</span>)</span>List&lt;Integer&gt; addrs, @<span class="title">Param</span><span class="params">(<span class="string">"gender"</span>)</span><span class="keyword">char</span> gds)</span>;</div></pre></td></tr></table></figure>
<p>åœ¨mapperæ–‡ä»¶é‡Œï¼Œç”¨ @Param é‡Œçš„æ³¨è§£åç§°æ¥å–å‚æ•°ï¼Œä¾‹å¦‚è¿™é‡Œçš„addresså’Œgenderï¼ŒSQLé‡Œå–å‚æ•°æ–¹å¼ä¸å˜ï¼Œç”¨#{gender}æˆ–${gender}ã€‚</p>
<h3 id="4ã€insertå’Œselectè¯­å¥è°ƒä¼˜ï¼ˆ2016-07-21-è¡¥å……ï¼‰"><a href="#4ã€insertå’Œselectè¯­å¥è°ƒä¼˜ï¼ˆ2016-07-21-è¡¥å……ï¼‰" class="headerlink" title="4ã€insertå’Œselectè¯­å¥è°ƒä¼˜ï¼ˆ2016-07-21 è¡¥å……ï¼‰"></a>4ã€insertå’Œselectè¯­å¥è°ƒä¼˜ï¼ˆ2016-07-21 è¡¥å……ï¼‰</h3><p>åœ¨æ’å…¥æˆ–æŸ¥è¯¢æ—¶ï¼Œåœ¨mapperæ–‡ä»¶é‡Œï¼Œselectè¦å†™resultMapæ ‡ç­¾æ¥æ˜ å°„å±æ€§å’Œåˆ—çš„å…³ç³»ï¼Œinsertè¯­å¥è¦å†™ä¸€ä¸ªforeachè¯­å¥æ¥æ‹¼æ¥valuesåé¢çš„å†…å®¹ï¼Œè¿™ä¸€åˆ‡éƒ½æ²¡æœ‰é—®é¢˜ï¼Œä½†æ˜¯å½“ä¸€æ¬¡æ€§æŸ¥è¯¢æˆ–æ’å…¥ä¸Šåƒã€ä¸Šä¸‡æ¡æ•°æ®ï¼ŒMybatiså°±æ˜¾å¾—åŠ›ä¸ä»å¿ƒã€‚Mybatisè™½ç„¶æœ‰å¼ºå¤§çš„åŠ¨æ€æ‹¼æ¥SQLçš„èƒ½åŠ›ï¼Œä½†æ­¤æ—¶åº”ç”¨æ¯”è¾ƒç®€å•ï¼Œå¯ä»¥è€ƒè™‘å°½é‡å‡å°‘Mybatisçš„å·¥ä½œï¼ŒæŠŠå®ƒä»…ä»…å½“åšæ˜¯SQLè¯­å¥æ¥æ‰§è¡Œã€‚     </p>
<p>å¯¹insertè¯­å¥ï¼Œvaluesåé¢çš„å†…å®¹å¯ä»¥é¢„å…ˆåœ¨Javaä»£ç é‡Œæ‹¼æ¥å¥½ï¼Œç›´æ¥ä¼ å…¥ï¼š<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">"insertPOJO"</span> <span class="attr">parameterType</span>=<span class="string">"java.util.List"</span>&gt;</span></div><div class="line">    insert into </div><div class="line">        table(...)</div><div class="line">    values</div><div class="line">        <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">"list"</span> <span class="attr">item</span>=<span class="string">"value"</span> <span class="attr">open</span>=<span class="string">"("</span> <span class="attr">separator</span>=<span class="string">","</span> <span class="attr">close</span>=<span class="string">")"</span>&gt;</span></div><div class="line">            $&#123;value&#125;</div><div class="line">        <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>ç”šè‡³ï¼Œè¿foreachæ ‡ç­¾ä¹Ÿå»æ‰ï¼Œåœ¨Javaé‡Œå°±å…¨éƒ¨æ‹¼æ¥å¥½ã€‚ä¸è¿‡æˆ‘æ¯”è¾ƒå€¾å‘äºä¸Šé¢è¿™ç§ï¼Œå¯ä»¥çœ‹å‡ºæ˜¯æ’å…¥å¤šæ¡æ•°æ®ï¼Œåˆä¸è‡³äºæ’å…¥é€Ÿç‡å¤ªæ…¢ã€‚  </p>
<p>å¯¹selectè¯­å¥ç±»ä¼¼ï¼š<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selectPOJO"</span> <span class="attr">resultType</span>=<span class="string">"java.util.Map"</span>&gt;</span></div><div class="line">    select </div><div class="line">        *</div><div class="line">    from</div><div class="line">        table</div><div class="line">    where</div><div class="line">        ...    </div><div class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>è¿™é‡Œè®©è¿”å›å€¼ä¸ºMapï¼Œåœ¨Javaé‡Œç”¨ List&lt;Map&lt;Object, Object&gt;&gt; æ¥æ”¶ï¼Œå‰©ä¸‹çš„å·¥ä½œå°±æ˜¯å°†è¿”å›ç»“æœå†è½¬æ¢ä¸ºList&lt;Pojo&gt;å¯¹è±¡ã€‚å·¥ä½œé‡å¢åŠ äº†ä¸€äº›ï¼Œä½†å¯¹æ•°æ®æµè¾ƒå¤§çš„æŸ¥è¯¢ï¼Œæ€§èƒ½æå‡æ¯”è¾ƒæ˜æ˜¾ï¼ŒæŸ¥ä¸€ä¸‡æ¡ï¼ˆæ¯æ¡æ¥è¿‘40åˆ—ï¼‰ä»æ¥è¿‘ä¸¤ç§’å‡å°‘åˆ°ä¸åˆ°ä¸€ç§’ï¼Œè¿˜æ˜¯å€¼å¾—çš„ã€‚</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>





<nav id="pagination">
  
  
  <div class="clearfix"></div>
</nav></div></div>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2016 ç‹ä¹å¿ƒçš„åšå®¢
  
  <p>Theme by <a href="https://caisiduo.xyz" target="_blank">LightOne</a></p>
</div>
<div class="clearfix"></div></footer>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>




<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>

</body>
</html>
